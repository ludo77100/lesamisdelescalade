 <!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout}">
<head>
<meta charset="UTF-8" />
<title>Liste des spots</title>

<link rel="stylesheet" type="text/css"
	href="../static/css/bootstrap.min.css"
	th:href="@{/css/bootstrap.min.css}">
</head>
<body>

	<!-- Cette page permet d'afficher la liste des spots, c'est également ici que l'ont peut faire une recherche et que sont affichés les résultats d'une recherche -->

	<div layout:fragment="content">
		<div class="container-fluid">

			<!-- Barre de recherche de spot, recherche dans le nom du spot -->

			<form th:action="@{/listeSpot}" method="get">
				<input type="search" name="mc" th:value="${mc}"></input>
				<button class="btn btn-primary">Chercher</button>
			</form>

			<!-- Début du tableau de la liste des spots d'escalade, le retour de résultats de la rechereche s'affiche ici -->

			<div class="col-lg-12 spacer">
				<table class="table">
					<thead>
						<tr>
							<th>Nom</th>
							<th>Localité</th>
							<th>Cotation minimal</th>
							<!-- 
							Cette partie du tableau ne s'affiche que pour les administrateurs
							 -->
							<th>Editer</th>
							<th>Supprimer</th>

						</tr>
					</thead>
					<tbody>
						<tr th:each="s:${listeSpot}">
							<td><a th:text="${s.nom}"
								th:href="@{spot/{spotId}(spotId=${s.idSiteEscalade})}"></a></td>
							<td th:text="${s.localite}"></td>
							<td th:text="${s.cotationMin}"></td>
							<!-- 
							Cette partie du tableau ne s'affiche que pour les administrateurs
							 -->
							<td th:if="${(#authorization.expression('hasAuthority(''ADMINISTRATOR'')')) OR (s.utilisateur.idUtilisateur == #authentication.getPrincipal().getIdUtilisateur())}"
							th:href="@/editSpot/{spotId}(spotId=${s.idSiteEscalade})">Editer</td>
							<td th:if="${(#authorization.expression('hasAuthority(''ADMINISTRATOR'')')) OR (s.utilisateur.idUtilisateur == #authentication.getPrincipal().getIdUtilisateur())}"><a onclick="return confirm('Etes vous sur ? Cela va effacer les secteur, voies et longueurs associés à ce spot')"
							th:href="@{/deleteSpot/{spotId}(spotId=${s.idSiteEscalade})}">Supprimer</a></td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>

		<!-- Fin du tableau de la liste de spot, début de la barre de pagination -->

		<div class="navbar navbar-expand-lg navbar-light bg-light">
			<ul class="navbar-nav">
				<li th:class="${pageCourante} == ${status.index}?'active':''"
					class="nav-item" th:each="page, status:${pages}"><a
					class="nav-link"
					th:href="@{listeSpot(page=${status.index}, pc=${p})}"
					th:text="${status.index + 1}"></a></li>
			</ul>
		</div>
	
		</div>

		<!-- Fin de la barre de pagination -->


</body>
</html>